# Release Notes: v0.1.0

**Target Release Date:** TBD
**Type:** Feature Release
**Status:** In Development

---

## Summary

Major feature release with UX improvements, custom tooltips, task sorting, and responsive layout.

---

## Feature 1: Top Bar Configuration

Move data column parameters from sidebar to top bar for better alignment with standard Dataiku chart patterns.

**Parameters in Top Bar (7):**
| Parameter | Label | Mandatory |
|-----------|-------|-----------|
| `idColumn` | Task ID | Yes |
| `nameColumn` | Task Name | No |
| `startColumn` | Start Date | Yes |
| `endColumn` | End Date | Yes |
| `progressColumn` | Progress (%) | No |
| `dependenciesColumn` | Dependencies | No |
| `colorColumn` | Color By | No |

**Parameters in Sidebar (13):**
- **View Settings:** viewMode, viewModeSelect, scrollTo, sortBy (NEW)
- **Appearance:** barHeight, barCornerRadius, minColumnWidth, padding
- **Behavior:** readonly, popupOn, todayButton, highlightWeekends, tooltipColumns (NEW)
- **Performance:** maxTasks

---

## Feature 2: Custom Tooltips

Allow users to add custom data fields to task popups.

**Configuration:**
- New `tooltipColumns` multi-select parameter (max 5 fields)
- Located in Behavior section of sidebar

**Behavior:**
- Each custom field displayed on a new line
- Dates formatted in locale-appropriate style using `Intl.DateTimeFormat`
- Long text wraps appropriately

**Implementation:**
- Backend includes selected columns in task object as `custom_fields: {}`
- Frontend uses Frappe's structured popup API: `set_title()`, `set_details()`

---

## Feature 3: Task Sorting

Add sort options for controlling task ordering.

**Location:** Sidebar â†’ View Settings section

**Sort Options (10):**
| Value | Label | Description |
|-------|-------|-------------|
| `none` | Dataset Order | No sorting (default) |
| `start_asc` | Start Date (Earliest First) | Timeline overview |
| `start_desc` | Start Date (Latest First) | Recent work focus |
| `end_asc` | End Date (Earliest First) | Deadline tracking |
| `end_desc` | End Date (Latest First) | Long-term view |
| `name_asc` | Name (A-Z) | Alphabetical |
| `name_desc` | Name (Z-A) | Reverse alphabetical |
| `duration_asc` | Duration (Shortest First) | Quick wins |
| `duration_desc` | Duration (Longest First) | Major efforts |
| `dependencies` | Dependencies (Topological) | Critical path |

**Implementation:**
- New `sort_utils.py` module with Kahn's algorithm for topological sort
- Sorting applied in backend before maxTasks limit

---

## Feature 4: Always Fit to Screen

Chart automatically expands to fill available viewport width.

**Behavior:**
- Dynamic column width calculated based on viewport and date range
- Minimum column width constraint (20px) for readability
- Responsive: recalculates on window resize

**Implementation:**
```javascript
const viewportWidth = container.clientWidth;
const dateCount = calculateDateRange(tasks, viewMode);
const calculatedWidth = Math.max(minColumnWidth, Math.floor(viewportWidth / dateCount));
```

**Configuration Change:**
- `columnWidth` renamed to `minColumnWidth` (floor for auto-calculation)

---

## Bug Fixes

### OOM Risk Mitigation
- Add row limit parameter to `dataset.get_dataframe()` call
- Leverage `maxTasks` config at data loading level

### Pandas Deprecation Warning
- Remove deprecated `infer_datetime_format` parameter from `pd.to_datetime()`

---

## Files Modified

| File | Changes |
|------|---------|
| `webapps/gantt-chart/webapp.json` | topBar, topBarParams, sortBy, tooltipColumns, minColumnWidth |
| `webapps/gantt-chart/backend.py` | Pass new config to transformer, row limit |
| `python-lib/ganttchart/task_transformer.py` | Custom fields, sorting integration |
| `python-lib/ganttchart/sort_utils.py` | NEW: Sort implementations |
| `python-lib/ganttchart/date_parser.py` | Remove deprecated parameter |
| `resource/webapp/app.js` | Popup rewrite, date formatting, dynamic column width |
| `plugin.json` | Version bump to 0.1.0 |
| `tests/python/unit/test_sort_utils.py` | NEW: Sort tests |

---

## Testing Requirements

- [ ] Top bar displays 7 data column pickers
- [ ] Sidebar displays View Settings with sortBy
- [ ] Custom tooltip fields display in popup (max 5)
- [ ] Dates formatted in locale-appropriate style
- [ ] All 10 sort options work correctly
- [ ] Topological sort handles dependencies
- [ ] Chart fills viewport width
- [ ] Resize recalculates layout
- [ ] All 77+ tests pass
- [ ] No pandas deprecation warnings

---

## Migration Notes

**Breaking Changes:**
- `columnWidth` parameter renamed to `minColumnWidth`
- Chart now auto-fits to screen (previous fixed-width behavior changed)

**Upgrade Path:**
- Existing charts will use new auto-fit behavior
- Previous `columnWidth` values become minimum constraint
