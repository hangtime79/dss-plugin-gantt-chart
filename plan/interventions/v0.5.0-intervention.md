# v0.5.0 UI Overhaul - Intervention Record

## Status: Cleanup In Progress
**Created:** 2025-12-25 (retroactive, post-handoff)
**Original Author:** Junior Developer
**Cleanup By:** Senior Architect

---

## Overview

Comprehensive UI modernization for the Gantt Chart plugin, including design system implementation, control bar, skeleton loader, and visual polish.

---

## What Was Implemented

### Design System (style.css)
- [x] CSS custom properties for colors, spacing, typography
- [x] System font stack (air-gap safe)
- [x] BEM-like component naming

### Control Bar (body.html, app.js)
- [x] Header bar with brand title
- [x] View mode dropdown (custom, replaces library widget)
- [x] Zoom in/out buttons with percentage indicator
- [x] Today button

### Loading State
- [x] Skeleton loader replacing spinner
- [x] CSS-only animation (no external deps)

### Visual Polish
- [x] Rounded bars, softer colors
- [x] Lightened grid lines
- [x] Card-style tooltips with shadows

---

## Issues Found During Review

### Critical: DOCTYPE in body.html
**Problem:** Junior added `<!DOCTYPE html>` to body.html, causing browser Quirks Mode.

**Root Cause:** Misunderstanding of Dataiku's iframe embedding. The body.html is a fragment injected into Dataiku's iframe wrapper, not a standalone document.

**Fix:** Removed the DOCTYPE line.

**Note:** Quirks Mode warning may persist because Dataiku's iframe wrapper itself lacks a DOCTYPE. This is a platform issue, not plugin-fixable.

### Critical: Bar labels invisible (dark text on dark bars)
**Problem:** Junior changed default `.gantt .bar-label` fill from `#fff` (white) to `var(--text-main)` (dark #2d3436).

**Root Cause:** Comment said "Default to DARK for safety" â€” exactly backwards. Bars are colored; labels need to contrast.

**Fix:** Restored `fill: #ffffff !important` as the default.

### Minor: plugin.json formatting noise
**Problem:** Unnecessary reformatting (removed blank lines, expanded array) created diff noise.

**Fix:** Restored original formatting, only version bump changed.

---

## Protocol Violations Identified

| Issue | Details |
|-------|---------|
| Spec naming | Used `feature-v0.5.0-ui-overhaul-spec.md` instead of `feature-v0.5.0-spec.md` |
| Linked Issues | Vague reference instead of GitHub issue numbers |
| Rollback Plan | Missing from spec |
| Intervention file | Never created despite 7 iterations |
| User QA Gate | Committed with known errors |

---

## Files Modified

| File | Status | Notes |
|------|--------|-------|
| `resource/webapp/style.css` | Complete | Design system implemented |
| `webapps/gantt-chart/body.html` | Fixed | Removed DOCTYPE |
| `webapps/gantt-chart/app.js` | Complete | Control bar logic added |
| `plugin.json` | Fixed | Version 0.5.0, formatting restored |
| `plan/specs/feature-v0.5.0-ui-overhaul-spec.md` | Exists | Naming non-standard |

---

## Remaining Work

- [ ] User QA to verify Quirks Mode error resolved
- [ ] Commit cleanup fixes
- [ ] Update CLAUDE.md session state after merge

---

## Lessons Learned

1. **Iframe context matters** - Plugin body.html files are fragments, not documents
2. **Intervention files prevent churn** - 7 iterations could have been avoided with proper tracking
3. **Read protocols before starting** - All docs were available but not followed
