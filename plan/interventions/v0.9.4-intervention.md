# v0.9.4 Intervention - Tooltip Polish

## Current State: DEBUGGING POSITIONING

**Branch:** `feature/v0.9.4-tooltip-polish`
**Issues:** #66 (positioning), #67 (appearance)

---

## Problem Being Debugged

Tooltip positioning is incorrect:
- Tooltip appearing ~60px down instead of 30px
- ~180px overlap between taskbar and tooltip instead of 30px gap

## User's Desired Positioning Logic

```
1. Get bottom-left coordinate of task bar
2. Offset 30px right, 30px down from that point
3. That offset point = tooltip's TOP-RIGHT corner
4. Tooltip body extends LEFTWARD (trails behind the task)
```

Visual:
```
              Task Bar
        ┌─────────────────────────────┐
        │                             │
        └─────────────────────────────┘
         ↑ bottom-left
         │ +30px right, +30px down
         ↓
┌─────────────────┐ ← tooltip top-right (closest to bar)
│    TOOLTIP      │
│   (extends      │
│    leftward)    │
└─────────────────┘
```

## Current Debug State

Added console logging (commit `5a09a96`) that outputs all 4 corners of:
- Task bar (in container coordinates)
- Tooltip (final position)

**Next step:** User will provide console output to diagnose positioning bug.

---

## Completed Work

### #67 - Appearance (PASSED QA)
- [x] Reduced padding from 10px to 5px
- [x] Dark mode: 3px border + shadow for contrast

### #66 - Positioning (FAILED QA - debugging)
- [x] Initial implementation (incorrect)
- [x] Corrected implementation using user's approach
- [x] Added debug logging
- [ ] Fix based on debug output
- [ ] Remove debug code
- [ ] User QA

---

## Files Modified

| File | Status | Changes |
|------|--------|---------|
| `webapps/gantt-chart/app.js` | Modified | show_popup monkey-patch + debug logging |
| `resource/webapp/style.css` | Modified | Padding 5px, dark mode border 3px |
| `plugin.json` | Modified | Version 0.9.4 |
| `plan/specs/feature-v0.9.4-spec.md` | Created | Spec file |

---

## Key Code Location

**Positioning patch:** `webapps/gantt-chart/app.js` lines 997-1049

```javascript
// Patch show_popup to anchor tooltip trailing behind task bar (#66)
const originalShowPopup = ganttInstance.show_popup.bind(ganttInstance);
ganttInstance.show_popup = function(opts) {
    // ... positioning logic here
    // ... debug logging here
    originalShowPopup(opts);
};
```

**Library's internal offset:** The library adds +10 to x and -10 to y when setting popup position.

---

## Git State

```
feature/v0.9.4-tooltip-polish (3 commits ahead of main)
├── d735121 feat(v0.9.4): Tooltip positioning and appearance polish (#66, #67)
└── 5a09a96 debug: Add tooltip positioning console logs (all 4 corners)
```

---

## Resume Instructions

1. Ask user for console debug output from clicking a task
2. Analyze the coordinates to find the bug
3. Fix positioning calculation
4. Remove debug code
5. Commit and request User QA
6. On pass: Run branch-exit-protocol
