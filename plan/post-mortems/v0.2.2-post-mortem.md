# Post-Mortem: v0.2.2

**Branch:** `bugfix/v0.2.2-fix-filter-init-race`
**Type:** Bugfix
**Duration:** 1 day (Started: 2025-12-20, Completed: 2025-12-20)
**Outcome:** âœ… Success

---

## Summary

Successfully diagnosed and fixed a race condition where the Gantt chart would render before receiving filter state from Dataiku. The fix involved removing the premature synchronous initialization and relying solely on the asynchronous `postMessage` flow.

---

## Scope

### Planned
- [x] Fix filter initialization race condition

### Delivered
- [x] Fix filter initialization race condition

### Deferred Items
None.

---

## Timeline

| Milestone | Planned | Actual | Variance |
|-----------|---------|--------|----------|
| Start | 2025-12-20 | 2025-12-20 | - |
| Fix implemented | 2025-12-20 | 2025-12-20 | - |
| Testing complete | 2025-12-20 | 2025-12-20 | - |
| Release | 2025-12-20 | 2025-12-20 | - |

---

## Commit Analysis

| Metric | Value | Assessment |
|--------|-------|------------|
| Total commits | 1 (pending) | |
| Feature commits | 0 | |
| Fix/debug commits | 1 | |
| Reverts | 0 | |
| Churn ratio | 0% | ðŸŸ¢ Low |

---

## What Went Well

- **Diagnosis:** The root cause (synchronous `getWebAppConfig` vs asynchronous message) was identified quickly from the symptoms.
- **Verification:** User QA confirmed the fix immediately.

---

## What Didn't Go Well

- **Test Infrastructure:** Backend unit tests are failing due to environment issues (`PLUGIN_INTEGRATION_TEST_INSTANCE` missing), preventing automated regression testing. This needs to be addressed for future backend work.

---

## Blockers Encountered

None.

---

## Technical Discoveries

### Platform Behavior
- **`dataiku.getWebAppConfig()` Limitations:** This synchronous method is useful for getting initial parameters but *does not* include the current state of Dataiku filters. Filter state is only available via the response to `window.parent.postMessage("sendConfig", "*")`.

---

## CLI Docs Candidates

1. **Webapp Filters Initialization**: `dataiku.getWebAppConfig()` lacks filter state; must use `postMessage` flow.

---

## Recommendations

### For Next Release
- Address the unit test environment configuration to ensure tests can run reliably.

### Lessons Learned
1. Always distrust synchronous config methods when dealing with dynamic state like filters or selection.
2. The `postMessage` flow is the source of truth for the complete webapp context (config + filters).
