# Post-Mortem: v0.2.1

**Branch:** `bugfix/v0.2.1-fix-horizontal-scrolling`
**Type:** Bugfix
**Duration:** 1 day (Started: 2025-12-20, Completed: 2025-12-20)
**Outcome:** âœ… Success (after 3 attempts)

---

## Summary

Restored horizontal and vertical scrolling for the Gantt chart. The fix required three attempts due to duplicate file locations and incorrect CSS approach. Final solution: let Frappe Gantt control its own container height, put `overflow: auto` on our outer container.

---

## Scope

### Planned
- [x] Fix horizontal scrolling
- [x] Fix vertical scrolling

### Delivered
- [x] Scrollbars appear when content exceeds viewport
- [x] Touchpad/mousewheel scrolling works
- [x] Colors preserved (no regression)

---

## Timeline of Attempts

| Attempt | Commit | Problem | Result |
|---------|--------|---------|--------|
| 1 | 4d4e65c | Edited wrong file (`webapps/gantt-chart/style.css` instead of `resource/webapp/style.css`) | CSS not loaded |
| 2 | 77918c7 | Tried to consolidate files, assumed Dataiku auto-loads CSS from webapp folder | Colors disappeared |
| 3 | (uncommitted) | Found Frappe uses CSS variable for height; our `height: 100%` override broke scrolling | âœ… Fixed |

---

## Root Cause Analysis

### Problem 1: Duplicate File Locations
The plugin has two locations for CSS:
- `webapps/gantt-chart/style.css` - NOT loaded by browser
- `resource/webapp/style.css` - Loaded via explicit `<link>` in body.html

SDE modified the wrong file in attempt 1.

### Problem 2: Incorrect CSS Architecture
The attempted fix used:
```css
#gantt-container { overflow: hidden }    /* Outer clips */
.gantt-container { height: 100%; overflow: auto }  /* Inner scrolls */
```

This broke because Frappe Gantt sets `.gantt-container` height dynamically:
```css
/* Frappe's CSS */
.gantt-container { height: var(--gv-grid-height); }
```

Our `height: 100%` override forced the container to viewport height, eliminating overflow.

### Correct Solution
```css
#gantt-container { overflow: auto }  /* Our container scrolls */
/* Do NOT override .gantt-container height */
```

---

## Commit Analysis

| Metric | Value | Assessment |
|--------|-------|------------|
| Total commits | 3 | |
| Fix commits | 2 | |
| Docs commits | 1 | |
| Churn ratio | 66% | ðŸ”´ High |

**Why high churn:** Multiple attempts due to incorrect diagnosis and duplicate file structure.

---

## What Went Well

- Eventually found the correct solution
- Documented the investigation thoroughly in spec
- Added explanatory CSS comments to prevent future mistakes

---

## What Didn't Go Well

- Edited wrong file initially (duplicate file locations)
- Incorrect assumption that Dataiku auto-loads CSS from webapp folder
- Didn't investigate Frappe Gantt's CSS before writing override
- Premature documentation (release notes/post-mortem written before fix verified)

---

## Blockers Encountered

| Blocker | Impact | Resolution | Time Lost |
|---------|--------|------------|-----------|
| Duplicate style.css files | Fix applied to wrong file | Identified via body.html analysis | ~1 hour |
| Frappe's dynamic height | Our CSS override broke scrolling | Read frappe-gantt.css, found CSS variable | ~1 hour |

---

## Technical Discoveries

### Dataiku Platform Behavior
- **CSS Loading:** Dataiku does NOT auto-load `style.css` from `webapps/{name}/` folder
- **Resource Serving:** Must use `resource/` folder and explicit `<link>` in body.html

### Frappe Gantt Behavior
- Uses CSS variable `--gv-grid-height` for container height
- Calculates height based on number of task rows
- Overriding with `height: 100%` breaks scrolling

---

## CLI Docs Candidates

1. **Dataiku CSS Loading**
   - Files in `webapps/{name}/` are not served as static resources
   - Use `resource/` folder for CSS/JS that needs explicit loading
   - Add `<link>` tag in body.html to load custom CSS

2. **Frappe Gantt Container Sizing**
   - Do not override `.gantt-container` height
   - Frappe uses `--gv-grid-height` CSS variable for dynamic sizing
   - Put `overflow: auto` on your outer wrapper, not Frappe's container

---

## Recommendations

### For Next Release
- Verify changes in browser before documenting
- Check DevTools Network tab to confirm CSS loads

### Process Improvements
- Eliminate duplicate file locations
- Add to release checklist: "Verify scrolling works"

### Technical Debt
- Consider removing `webapps/gantt-chart/style.css` since it's not used
- Or consolidate to single CSS location with clear documentation

---

## Lessons Learned

1. **Check which files are actually loaded** - Use DevTools Network tab
2. **Don't override library CSS blindly** - Read the library's CSS first
3. **Test before documenting** - Verify fix works before writing release notes
4. **Duplicate files cause bugs** - Same filename in multiple locations is confusing
